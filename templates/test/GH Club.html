<!DOCTYPE html>
<html lang="en" style="width: 100%; height: 100%;"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GH Club</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap" rel="stylesheet">
    <style>.place span {
        font-family: "Bebas Neue";
        letter-spacing: -0.5vmax;
        position: absolute;
        top: 50%;
        left: 50%;
        -ms-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
        font-size: 4.5vw;
        }</style>
</head>
    <body style="width: 100%; height: 100%; background: black; margin: 0px;">
    <nav style="position: absolute; top: 0px; width: 30%; height: 50%; left: 0px;"><div style="position: sticky; width: 100%; height: 100%; overflow: scroll;"><ul id="news_ul" style="list-style-type: square; color: white; font-family: &quot;Gill Sans&quot;, sans-serif; font-size: 1.3vw; padding-inline-start: 5%; margin-top: 6vw;"></ul><input type="text" id="news_input" placeholder="Новости..."><span class="add_btn" style="background: white;">✓</span></div><div class="logo" style="width: 100%; height: 5.45vw; top: 0px; left: 0px; overflow: hidden; position: absolute; background: rgb(107, 201, 151);"><span style="position: absolute; font-family: &quot;Bebas Neue&quot;; font-size: 7.8vw; text-align: center; top: -1.55vw; left: 0px;">GAME HOUSE</span></div></nav>
    <main><div class="wall" style="width: 2%; height: 50%; position: absolute; top: 0px; left: 60%; background: rgb(107, 201, 151);"></div><div class="wall" style="width: 2%; height: 34%; position: absolute; bottom: 0px; left: 60%; background: rgb(107, 201, 151);"></div><div class="wall" style="width: 2%; height: 34%; position: absolute; top: 0px; left: 79%; background: rgb(107, 201, 151);"></div><div class="wall" style="width: 26%; height: 46%; position: absolute; bottom: 0px; right: 0px; background: rgb(107, 201, 151);"></div><div id="place_1" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 18%; left: 0%; background: rgb(201, 183, 87);"><span>1</span></div><div id="place_2" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 18%; left: 10%; background: rgb(201, 183, 87);"><span>2</span></div><div id="place_3" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 18%; left: 20%; background: rgb(201, 183, 87);"><span>3</span></div><div id="place_4" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 18%; left: 30%; background: rgb(201, 183, 87);"><span>4</span></div><div id="place_5" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 18%; left: 40%; background: rgb(201, 183, 87);"><span>5</span></div><div id="place_6" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 18%; left: 50%; background: rgb(201, 183, 87);"><span>6</span></div><div id="place_7" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 0px; left: 0%; background: rgb(201, 183, 87);"><span>7</span></div><div id="place_8" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 0px; left: 10%; background: rgb(201, 183, 87);"><span>8</span></div><div id="place_9" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 0px; left: 20%; background: rgb(201, 183, 87);"><span>9</span></div><div id="place_10" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 0px; left: 30%; background: rgb(201, 183, 87);"><span>10</span></div><div id="place_11" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 0px; left: 40%; background: rgb(201, 183, 87);"><span>11</span></div><div id="place_12" class="place" style="position: absolute; height: 16%; width: 10%; bottom: 0px; left: 50%; background: rgb(201, 183, 87);"><span>12</span></div><div id="place_13" class="place" style="position: absolute; height: 16%; width: 9.5%; top: 18%; right: 0%; background: rgb(201, 183, 87);"><span>14</span></div><div id="place_14" class="place" style="position: absolute; height: 16%; width: 9.5%; top: 18%; right: 9.5%; background: rgb(201, 183, 87);"><span>15</span></div><div id="place_15" class="place" style="position: absolute; height: 16%; width: 9.5%; top: 0%; right: 0%; background: rgb(201, 183, 87);"><span>16</span></div><div id="place_16" class="place" style="position: absolute; height: 16%; width: 9.5%; top: 0%; right: 9.5%; background: rgb(201, 183, 87);"><span>17</span></div><div id="place_17" class="place" style="position: absolute; height: 16%; width: 9.5%; top: 36%; right: 0px; background: rgb(201, 183, 87);"><span>13</span></div><div id="place_18" class="place" style="width: 17%; height: 34%; position: absolute; top: 0px; left: 62%; background: rgb(201, 183, 87);"><span>PS</span></div><div id="place_19" class="place" style="width: 30%; height: 50%; position: absolute; top: 0px; left: 30%; background: rgb(201, 183, 87);"><span>PS</span></div></main>
    <script>
        function initialization() {
            //Set walls Color
            walls = document.querySelectorAll("div.wall")
            Array.from(walls, x => {
                x.style.background = "{{set.wall}}"
            })
            //Adding onclick for places 
            places = document.querySelectorAll("div.place")
            Array.from(places, x => {
                x.onclick = change_color
            })
            //Set logo Color
            logo = document.querySelector("div.logo")
            logo.style.background = "{{set.wall}}"
            //Adding onclik for add_btn
            add_btn = document.querySelector("span.add_btn")
            add_btn.onclick = add_news
            //Set bloks Colors 
            place_bloks = document.getElementsByClassName("place")
            {% for key, color in colors.items() %}
                style = "{{color}}" == "free" ? "{{set.free}}" : "{{set.busy}}"
                place_bloks["{{loop.index0}}"].style.background = style
            {% endfor %}
            //Adding News from db
            {% for key, item in news.items() %}
                add_news("{{item}}")
            {% endfor %}
        }
        initialization()
        //Create a new List Item when Clicking on add-button
        function add_news(str) {
            if(str.height == 1) {
                var li = document.createElement("li")
                var inputValue = document.getElementById("news_input").value
                var t = document.createTextNode(inputValue)
            }
            else { 
                var li = document.createElement("li")
                var t = document.createTextNode(str)
            }
            var ul = document.getElementById("news_ul")
            li.id = "item_" + Number(1 + ul.childNodes.length)
            li.appendChild(t)
            
            ul.insertBefore(li, ul.children[0])
            document.getElementById("news_input").value = ""

            //Close button and append it to each list item
            var span = document.createElement("span")
            var txt = document.createTextNode("\u00D7")
            span.className = "close"
            span.onclick = delete_news
            span.appendChild(txt)
            li.appendChild(span)
            if(str.height == 1) {
                post_request([li.id, t.data], "/add_news")
            }
        } 
        //Click on a close button to hide the current list item
        function delete_news() {
            var el = this 
            var li = this.parentElement
            el.style.display = "none"
            li.style.display = "none"
            post_request([li.id, li.textContent.slice(0, -1)], "/delete_news")
        }
        function post_request(info, url) {
            var xhr = new XMLHttpRequest()
            xhr.open("POST", url, true)
            xhr.setRequestHeader('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')
            xhr.onreadystatechange = function() {
                if(xhr.readyState === 4) {
                    console.log(xhr.response)
                }
            }
            xhr.send("key=" + info[0] + "&value=" + info[1])
        }
        function change_color() {
            var el = this
            
            if(el.style.background == "{{set.free}}") {
                el.style.background = "{{set.busy}}"
                post_request([el.id, "busy"], "/color")
            }
            else {
                el.style.background = "{{set.free}}"
                post_request([el.id, "free"], "/color")
            }
        }
    </script>
</body>
</html>